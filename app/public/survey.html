<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>GolfBuddy Survey</title>

    <!-- Bootstrap CSS & JS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css">
    <script src="https://code.jquery.com/jquery.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>


    <!--Glyphicons -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.1/css/font-awesome.min.css">

    <!-- Chosen -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/chosen/1.8.2/chosen.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/chosen/1.8.2/chosen.jquery.min.js"></script>



</head>

<body>
    <div class="container-fluid">

        <!-- Survey Header -->
        <h1>GolfBuddy Survey Questions</h1>
        <hr>

        <h2>About You</h2>
        <form>
            <label>Name (Required)</label>
            <input type="text" class="form-control" id="name" placeholder="Name" required>
            <br/>
            <label>Link to a Photo Image (Required)</label>
            <input type="text" class="form-control" id="imageLink" placeholder="Image Link" rquired />
        </form>

        <hr>

        <!-- Survey Questions -->

        <h3>Question 1</h3>
        <h4>It is fine to arrive just as others in the group are teeing off.</h4>
        <select class="chosen-select" id="q1">
            <option value></option>
            <option value="1">1 (Strongly Disagree)</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5 (Strongly Agree)</option>
        </select>

        <h3>Question 2</h3>
        <h4>The most important feature of a driver is the color of the shaft.</h4>
        <select class="chosen-select" id="q2">
            <option value></option>
            <option value="1">1 (Strongly Disagree)</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5 (Strongly Agree)</option>
        </select>

        <h3>Question 3</h3>
        <h4>After a bad shot, you should throw the offending club into the nearest body of water.</h4>
        <select class="chosen-select" id="q3">
            <option value></option>
            <option value="1">1 (Strongly Disagree)</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5 (Strongly Agree)</option>
        </select>

        <h3>Question 4</h3>
        <h4>Playing music so loud that everyone on the course can hear it is fun.</h4>
        <select class="chosen-select" id="q4">
            <option value></option>
            <option value="1">1 (Strongly Disagree)</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5 (Strongly Agree)</option>
        </select>

        <h3>Question 5</h3>
        <h4>Cocktails and golf, a match made in heaven.</h4>
        <select class="chosen-select" id="q5">
            <option value></option>
            <option value="1">1 (Strongly Disagree)</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5 (Strongly Agree)</option>
        </select>

        <h3>Question 6</h3>
        <h4>A round should last at least 5 hours.</h4>
        <select class="chosen-select" id="q6">
            <option value></option>
            <option value="1">1 (Strongly Disagree)</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5 (Strongly Agree)</option>
        </select>

        <h3>Question 7</h3>
        <h4>There is no reason to ever smile while golfing.</h4>
        <select class="chosen-select" id="q7">
            <option value></option>
            <option value="1">1 (Strongly Disagree)</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5 (Strongly Agree)</option>
        </select>

        <h3>Question 8</h3>
        <h4>Hecklers are always welcome.</h4>
        <select class="chosen-select" id="q8">
            <option value></option>
            <option value="1">1 (Strongly Disagree)</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5 (Strongly Agree)</option>
        </select>

        <h3>Question 9</h3>
        <h4>Shoes must match the belt.</h4>
        <select class="chosen-select" id="q9">
            <option value></option>
            <option value="1">1 (Strongly Disagree)</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5 (Strongly Agree)</option>
        </select>

        <h3>Question 10</h3>
        <h4>Colored golf balls are fun.</h4>
        <select class="chosen-select" id="q10">
            <option value></option>
            <option value="1">1 (Strongly Disagree)</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5 (Strongly Agree)</option>
        </select>

        <br/>
        <br/>

        <button type="submit" class="btn btn-lg btn-primary" id="surveySubmit">
            <span class="glyphicon glyphicon-list-alt"></span> Submit Your Survey</button>


        <!-- Modal / ChosenFriend -->
        <div class="modal fade" id="chosenModal" tabindex="-1" role="dialog">
            <div class="modal-dialog" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                        <h4 class="modal-title">Your new GolfBuddy is...</h4>
                    </div>
                    <div class="modal-body">

                        <div id="chosenName"></div>
                        <br/>
                        <img id="chosenImage" src="" alt="Picture of your new GolfBuddy" style="width:300px; height:250px;"/>

                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                    </div>
                </div> 
            </div> 
        </div> 


        <!-- Footer -->
        <hr>
        <footer>
          <p><a href="/api/friends">API GolfBuddies List</a></p>

        </footer>
    
    </div>
    <!-- Container-fluid -->



    <script type="text/javascript">

            $("#surveySubmit").on("click", function (event) {
                    event.preventDefault();

/**
 * @function validateForm
 * isFilled boolean variable for form validation
 * reviews for to ensure all text and select box questions are completed
 * 
 * @param {object} newUserInfo object containing user survey information;
 * @param {string} name newUserInfo name
 * @param {string} image newUserInfo image url
 * @param {array} scores array of answers from 10 questions
 * 
 */
                    function validateForm() {
                        var isFilled = true;
                        $(".form-control").each(function () {
                            if ($(this).val() === "") {
                                isFilled = false;
                            }
                        });
                        $(".chosen-select").each(function () {
                            if ($(this).val() === "") {
                                isFilled = false;
                            }
                        });
                        return isFilled;
                    } 

                    if (validateForm()) {

                        var newUserInfo = {
                            name: $("#name").val().trim(),
                            image: $("#imageLink").val().trim(),
                            scores: [
                                $("#q1").val(),
                                $("#q2").val(),
                                $("#q3").val(),
                                $("#q4").val(),
                                $("#q5").val(),
                                $("#q6").val(),
                                $("#q7").val(),
                                $("#q8").val(),
                                $("#q9").val(),
                                $("#q10").val()
                            ]
                        }; 

                        console.log("nUI", newUserInfo);

                        $.post("/api/friends", newUserInfo, function(data) {

                            if (data) {
                                $("#chosenName").text(data.name);
                                console.log(data.image);
                                $("#chosenImage").attr("src", data.image);

                                $("#chosenModal").modal("toggle");
                            } 

                        }); 
                            
                    } else {                                       
                            alert("Please complete and submit your survey.");
                        };                         

            });

    </script>
</body>

</html>